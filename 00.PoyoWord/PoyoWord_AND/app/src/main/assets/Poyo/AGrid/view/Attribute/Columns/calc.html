<!DOCTYPE html>
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1;text/html; charset=utf-8;" />

		<script>
			var SBpath = "../../../js/";
		</script>
		
		<script src="../../../js/SBGrid/SBGrid_Lib.js" type="text/javascript"></script>
		<script src="../../../js/SBGrid/SBGrid_min.js" type="text/javascript"></script>
		<link href="../../../js/SBGrid/css/SBGrid.css" rel="stylesheet" type="text/css">
		<link href="../../../js/SBGrid/css/SBGrid_Default.css" rel="stylesheet" type="text/css">
		<link href="../../../css/basic.css" rel="stylesheet" type="text/css">
		<link href="../../../css/common.css" rel="stylesheet" type="text/css">
		<script src="../../../data/data.js" type="text/javascript"></script>
		<script src="../../../js/toggle/toggle_attr.js" type="text/javascript"></script>
		<script src="../../../js/common.js" type="text/javascript"></script>

		<title>calc</title>

		<script type="text/javascript">
			var datagrid;
			var SBGridProperties = {};
			
			function createGrid(){
				
				SBGridProperties.parentid = 'SBGridArea';
				SBGridProperties.id = 'datagrid';
				SBGridProperties.jsonref = 'calcData';
				SBGridProperties.selectmode = 'free';
				SBGridProperties.columns = [
					{caption : ['이름','이름'],			ref : 'name',		width : '80px',	style : 'text-align:center',	type : 'output'},
					{caption : ['학번','학번'],		ref : 'number',	width : '80px',	style : 'text-align:center',	type : 'output' },
					{caption : ['점수','국어'],		ref : 'korean',	width : '80px',		style : 'text-align:center',	type : 'input'},
					{caption : ['점수','영어'],		ref : 'english',		width : '80px',		style : 'text-align:center',	type : 'input'},
					{caption : ['점수','수학'],			ref : 'math',		width : '80px',	style : 'text-align:center',	type : 'input' },
					{caption : ['합계','합계'],		ref : 'sum',		width : '80px',	style : 'text-align:center;background-color:#ffffe1', 	type : 'output',calc: 'fnCalcSum'},
					{caption :['평균','평균'],		ref : 'avg',		width : '80px',	style : 'text-align:center;background-color:#fbe18e;font-weight:bold',	type : 'output',
						calc:function(objGrid, nRow,nCol){
							var nSum = Number(objGrid.getCellData(Number(nRow), objGrid.getColRef('sum')));
							var strAvg = ((nSum / 3).toFixed(2)).toString();
							return strAvg;
						}
					}
				];
				datagrid = _SBGrid.create(SBGridProperties);
				datagrid.bind('afteredit','fnAfterEdit');
			};
			
			function fnAfterEdit(){
				if(datagrid.getPrevCol() == datagrid.getColRef('korean') || datagrid.getPrevCol() == datagrid.getColRef('english') || datagrid.getPrevCol() == datagrid.getColRef('math')){
					datagrid.refresh();
				}
			}
			
			function fnCalcSum(objGrid, nRow, nCol){
				var nKorean = Number(objGrid.getCellData(Number(nRow), objGrid.getColRef('korean')));
				var nEnglish = Number(objGrid.getCellData(Number(nRow), objGrid.getColRef('english')));
				var nMath = Number(objGrid.getCellData(Number(nRow), objGrid.getColRef('math')));
				var strSum = (nKorean + nEnglish + nMath).toString();
				return strSum;
			}
		</script>
	</head>

	<body>
		<div class="subTitle">
			<h2 class="title">calc</h2>
		</div>

		<p class="ctext4">Description</p>
		<ul class="descList">			
			<li> ● 데이터 변경시가 아닌 그리드 최초 생성시 및 그리드 refresh시 사용자 지정 function을 호출합니다.</li>
			<li> ● 해당 컬럼의 모든 행에서 function을 호출합니다.</li>
			<!-- <li> ● 주의 사항 : setCellData 등 사용자가 직접 데이터를 변경하지 않아도 refresh시 function을 호출합니다.</li> -->
			<li style="color:red;font-weight: bold;"> ● 주의 사항 : refresh시 function을 호출합니다.</li>
		</ul>
		<p class="ctext4">Value</p>
		<div class="example_box" style="width:90%;">
			<pre>
			
	<span style="font-weight: bold;"> * 컬럼속성 : calc : value1</span>
	   - value1 <span style="font-weight: bold;">(필수)</span> : <span style="font-weight: bold;">[string | object]</span> function 지정 or function 호출
		  → param1 (선택)  : [object] 선택한 그리드 객체(id)
		  → param2 (선택)  : [number] function이 적용된 행 인덱스
		  → param3 (선택)  : [number] function이 적용된 열 인덱스
			</pre>
		</div>
			<div class="ctext4">Example
				<input type="button" id = "clickb" class="buttonStyle" name="bt" value="code View" onclick="codeView()" />
			</div>
			<div class="example_box_e" id="toggle">
			<pre>
			<span class="comment"></span>
	var datagrid;
	var SBGridProperties = {};
	
	function createGrid(){
		
		SBGridProperties.parentid = 'SBGridArea';
		SBGridProperties.id = 'datagrid';
		SBGridProperties.jsonref = 'calcData';
		SBGridProperties.selectmode = 'free';
		SBGridProperties.columns = [
			{caption : ['이름','이름'],	ref : 'name',		width : '80px',	style : 'text-align:center',	type : 'output'},
			{caption : ['학번','학번'],	ref : 'number',	width : '80px',	style : 'text-align:center',	type : 'output'},
			{caption : ['점수','국어'],	ref : 'korean',		width : '80px',	style : 'text-align:center',	type : 'input'},
			{caption : ['점수','영어'],	ref : 'english',		width : '80px',	style : 'text-align:center',	type : 'input'},
			{caption : ['점수','수학'],	ref : 'math',		width : '250px',	style : 'text-align:center',	type : 'input' },
			{caption : ['합계','합계'],	ref : 'sum',		width : '130px',	style : 'text-align:center;background-color:#ffffe1', 					type : 'output',	<span class="highlight1">calc : 'fnCalcSum'</span>},
			{caption :['평균','평균'],	ref : 'avg',		width : '200px',	style : 'text-align:center;background-color:#fbe18e;font-weight:bold',	type : 'output',
				<span class="highlight1">calc : function(objGrid, nRow,nCol)</span> {
					var nSum = Number(objGrid.getCellData(Number(nRow), objGrid.getColRef('sum')));
					var strAvg = ((nSum / 3).toFixed(2)).toString();
					return strAvg;
				}
			}
		];
		datagrid = _SBGrid.create(SBGridProperties);
		datagrid.bind('afteredit','fnAfterEdit');
	};
	
	function fnAfterEdit(){
		if(datagrid.getPrevCol() == datagrid.getColRef('korean') || datagrid.getPrevCol() == datagrid.getColRef('english') || datagrid.getPrevCol() == datagrid.getColRef('math')){
			<span class="highlight1">datagrid.refresh();</span>
		}
	} 
	
	function <span class="highlight1">fnCalcSum(objGrid, nRow, nCol)</span> {
		var nKorean = Number(objGrid.getData(Number(nRow), objGrid.getColRef('korean')));
		var nEnglish = Number(objGrid.getData(Number(nRow), objGrid.getColRef('english')));
		var nMath = Number(objGrid.getData(Number(nRow), objGrid.getColRef('math')));
		var strSum = (nKorean + nEnglish + nMath).toString();
		return strSum;
	}
			</pre>
		</div>
		<p class="ctext4">Sample</p>
		<div class="gridDiv">
			점수를 수정해보세요.
			<div id="SBGridArea" class="gridStyle"></div>
		</div>
	</body>
</html>
